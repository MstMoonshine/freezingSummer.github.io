---
layout: post
title: 用线性空间思想寻找线性微分方程解的结构
tags: mathematica
---

最近物理课程开始了波动学部分，线性微分方程便是最常用的表达形式，结合上一篇中线性空间的思想，来探究一下线性微分方程解的结构。

### 线性微分算符

首先线性微分方程都具有如下形式：
\\[a_0y+a_1\frac{d}{dx}y+a_2\frac{d^2}{dx^2}y+...+a_n\frac{d^n}{dx^n}y=f(x)\\]
当右边恒为0时，称上式为n阶齐次线性微分方程，否则为非齐次线性微分方程。

不妨记\\(D=\frac{d}{dx}\\)，上式可重写为：
\\[a_0y+a_1Dy+a_2D^2y+...+a_nD^ny=f(x)\\]
\\(D\\)是一个算符，代表对后面的量关于x求导数。算符的概念类似矩阵，都是对其后方的量进行某种操作，自己单独存在并无具体意义。矩阵往往都是线性算符，而此处\\(D\\)也是典型的线性算符，因为显然有对数乘和加法封闭性：
\\[D(y_1+y_2)=Dy_1+Dy_2,D(cy)=cD(y)\\]
同理，\\(D^n\\)都是线性算符。

假如再偷懒一点，我们甚至能将\\(y\\)作为“公因式”提取出来，而将关于\\(D\\)的“多项式”整体看做一个“大”算符，记为\\(L\\)，即\\(L=a_0+a_1D+a_2D^2+...a_nD^n\\)，上式再次被改写如下：
\\[Ly=f(x)\\]
原来的微分方程已经面目全非了，尽管它们表示的是同一个方程。这种极简的形式对解微分方程显然不会带来任何益处，但是有利于我们直观地感受“线性”。

由于\\(D^n\\)是线性算符，那么\\(L\\)作为\\(D\\)的多项式，显然也是线性算符，即对\\(L\\)有：
\\[L(y_1+y_2)=Ly_1+Ly_2,L(cy)=cLy\\]

### 与线性微分方程有关的线性空间

根据上述\\(L\\)对加法和数乘的封闭性，对所有的\\(n\\)阶可导函数\\(y\\)，\\(Ly\\)形成了一个线性空间（可以类比对矩阵，所有的\\(Ax\\)形成了\\(A\\)的列空间）。我们不妨类比线性变换的称呼，把这个线性空间称为\\(L\\)的“range”（值域）（这只是个人通过类比独创的称呼）。

除了range，一个线性变换相关的另一个特征的线性空间就是它的kernel（核）了，同样我们类比来看看\\(L\\)是否有kernel：

对任意的\\(Ly_1=0,Ly_2=0\\)，根据\\(L\\)的线性性质，显然有：
\\[L(y_1+y_2)=0,L(cy_1)=0\\]
因此，所有满足\\(Ly=0\\)的n阶可导函数\\(y\\)形成了一个线性空间，也就是我们要找的\\(L\\)的kernel。

### 线性微分方程解的结构

依然通过类比，对于线性方程组\\(Ax=b\\)，其通解\\(x\\)的一般形式便是\\(x=x_p+x_n\\)，其中\\(x_p\\)是方程组的一个特解，\\(x_n\\)来自\\(A\\)的kernel。

那么对于\\(n\\)阶线性微分方程\\(Ly=f(x)\\)，我们可以推断解的一般结构为\\(y=y_p+y_n\\)，其中\\(y_p\\)是满足原方程的一个特解，\\(y_n\\)来自\\(L\\)的kernel。这很容易理解，因为对于\\(Ly_p=0\\)，一定有\\(L(y_p+y_n)=Ly_p+Ly_n=Ly_p+0=f(x)\\)，于是\\(y_p+y_n\\)也是原方程的解。

于是得到了微积分课本上通常会出现的一句冗长而不易理解的话：“线性微分方程的通解等于其一个特解加上对应齐次线性微分方程的通解”。

### 例

#### 导体棒在安培阻力作用下的v-t函数

这是一个高中时期的经典问题，没有外加电源的情况下，一般有两种题型：有恒力没初速度，有初速度没恒力。下面不妨将两种情况一起讨论，既有恒力作用又有初速度：

如图，一根导体棒可在一端闭合的光滑导轨上运动（有摩擦也可以，把摩擦放入恒力的一部分即可）。空间中有竖直向上的磁感应强度\\(B\\)，导轨电阻为\\(0\\)，间距为\\(l\\)，导体棒电阻为\\(R\\)。\\(t=0\\)导体棒速度\\(v=v_0\\)，此时给其施加一恒定外力\\(F\\)，求速度关于时间的函数\\(v(t)\\)。

![figure1](/images/posts/Linear_space&diffierential_equation/1.png)

解：“这是一道简单题”

首先受力分析，受到恒力\\(F\\)，安培阻力\\(F_A\\)，于是得运动方程：
\\[F-F_A=ma\\]
其中\\(F_A=IlB,I=\frac{E}{R},E=Blv\\)，于是得\\(F_A=\frac{B^2l^2v}{R}\\)（好怀念的表达式。。。至今仍深深印在脑中），带入上式：
\\[F-\frac{B^2l^2}{R}v=ma\\]

接下来高中的做法往往是定性分析出最后\\(F=F_A\\)而\\(a=0\\)，然而高中时求解了上面的运动方程，得到的结论是\\(F=F_A，a=0\\)永远不会出现，即使出现也是\\(t\rightarrow \infty\\)时，这一度让我困扰，并且抱怨高考题不符合实际，直到后来我给出了自己的解释。

现在站在高观点上来看这个方程，高中时我只是知道怎么解却不知道为什么那么解，现在我终于能够理解每一步是为什么。这是关于\\(v\\)的一个一阶非齐次线性微分方程，为了方便求解，我们把它写成：
\\[m\frac{dv}{dt}+kv-F=0,k=\frac{B^2l^2}{R}\\]
根据本文的结论，我们先要找到一个符合上述方程的特解，再去寻找\\(F=0\\)时所有的通解，加在一起便是所有可能的解，最后用初值条件便可以唯一地确定其运动。

特解自然越简单越好，我们不妨假设\\(v\\)是个定值，此时\\(\frac{dv}{dt}=0\\)，显然\\(v=\frac{F}{k}\\)。

然后来寻找\\(m\frac{dv}{dt}+kv=0\\)的通解：
\\[m\frac{dv}{v}=-kdt\\]
两边积分得：
\\[m\ln v+C=-kt,C只代表任意常数，不代表具体值\\]
\\[\ln v=-\frac{k}{m}t+C\\]
\\[v=e^{-\frac{k}{m}t+C}=Ce^{-\frac{k}{m}t}\\]
这便是\\(m\frac{dv}{dt}+kv=0\\)的通解。

于是原方程的通解为：
\\[v=\frac{F}{k}+Ce^{-\frac{k}{m}t}\\]
式中只有\\(C\\)是未定的量，根据\\(t=0\\)时\\(v=v_0\\)，得到：
\\[C=v_0-\frac{F}{k}\\]
重新整理得：
\\[v=\frac{F}{k}+(v_0-\frac{F}{k})e^{-\frac{k}{m}t},k=\frac{B^2l^2}{R}\\]

观察上式，一般情况下第二项是个衰减项，会迅速趋近于\\(0\\)，于是剩下第一项约等于\\(\frac{F}{k}\\)，这与高中定性分析结果一致。然而速度却永远不能精确等于这个值，这让我一度十分恼火。但物理上何来的精确等于呢？速度最终都是测不准的，我们给“等于”重新下个定义，在某个误差范围内（比如\\(10^{-5}m/s\\)），都被认为“相等”，这就可以说得通了。

再来仔细分析就会发现上式单调性很有趣，单调性取决于\\(v_0-\frac{F}{k}\\)，也就是初速度和最终稳定速度的大小关系。假如一开始\\(v_0=\frac{F}{k}\\)，那么会一直以这个速度运动下去；若\\(v_0>\frac{F}{k}\\)，电磁阻尼会把速度拉低，降到稳定速度；若\\(v_0<\frac{F}{k}\\)，恒力会把速度拉高，升高到稳定速度，如图：

![figure2](/images/posts/Linear_space&diffierential_equation/2.png)

# EOF
最后这个例子只是个一阶微分方程，是最简单的例子了，此处只是作为示例（而且这个微分方程是可以分离变量求解的）。其实波动学中往往遇到的是二阶微分方程，日后会在关于物理的文章里具体介绍。（话说至今我居然没写一篇关于物理的文章。。。真是奇迹）