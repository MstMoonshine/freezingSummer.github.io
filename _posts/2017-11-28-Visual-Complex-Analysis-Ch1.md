---
layout: post
tags: mathematica
title: 复分析学习笔记（一）
---

此前写的《追随大师的遗风系列》一直没有更新，是因为我在阅读第五小节的过程中卡住了。原因在于水平不够，还需要一段时间的积累才能完成理解。黎曼在第五小节中就用到了黎曼面的相关内容（他本人显然没有如此称呼黎曼面），因此阅读除了需要基础的复分析知识外，还需要对微分几何的了解。

《复分析：可视化方法》(Visual Complex Analysis)这本书此前也有提及，其内容将复分析和几何紧密联系在了一起。书中对非欧几何已有涉及，并按照作者所说，原本在最后打算写微分几何，但是篇幅受限，只好没写，但是书的最后三章已经为微分几何的内容做好了铺垫。

因此，我决定先把此书通读，并记录学习笔记，再攻读微分几何的内容。

# Chapter 1 -- 复数与几何

### 引入--三次方程求根

大部分教材总是喜欢通过二次方程求根来引入虚数，但这是不符合历史的，真正让人们意识到需要引入虚数是三次方程的求根。

方程的根可以转化为图像的交点，二次方程的根可以表示为一条抛物线和一条直线的交点。当方程判别式\\(\Delta<0\\)时，图像上并没有交点，人们很自然地会认为不存在根。因此即使当时虚数的概念已经提了出来，但是提出者本身也认为这样的数是毫无意义的，以至于命名为“虚”数（imaginary），需要虚数表示的根都被认为是不存在的。

然而这样的思路却不再适用于三次方程。

所有的三次方程都可以通过配方换元消去二次项，于是可以得到形如以下的方程：
\\[x^3=3px+2q\\]
如此形式的方程有求根公式：
\\[x=\sqrt[3]{q+\sqrt{q^2-p^3}}+\sqrt[3]{q-\sqrt{q^2-p^3}}\\]
（推导附在最后）

庞加莱考虑了方程\\(x^3=15x+4\\)，两条曲线\\(y=x^3\\)与\\(y=15x+4\\)交于点\\((4,64)\\)，\\(x=4\\)是上述方程显然的解，但是用求根公式得到：
\\[x=\sqrt[3]{2+11i}+\sqrt[3]{2-11i}\\]
此前的思路，认为虚数出现代表不存在根显然不适用了。庞加莱设想，如果有
\\[\sqrt[3]{2+11i}=2+ni,\sqrt[3]{2-11i}=2-ni\\]
那么求根公式给出的解\\((2+ni)+(2-ni)=4\\)就是合理的。

对于复数\\(x=a+bi,y=c+di\\)，假如满足一种看上去合理运算\\(xy=(a+bi)(c+di)=ac-bd+i(ad+bc)\\)，那么\\((2+i)^3=2+11i,(2-i)^3=2-11i\\)，上述猜想就是有道理的。

于是复数的概念自此引入。

### 复数运算法则
除了\\(z=x+iy\\)这样在直角坐标下的表示，复数还可以用极坐标形式表示，这将会带来很多便利。

复数的指数表示可以用欧拉公式\\(e^{i\theta}=\cos \theta+i\sin \theta\\)表示。证明十分简单，对\\(e^x,\sin x, \cos x\\)分别用泰勒展开，分别将\\(x=i\theta,x=\theta\\)代入，再将第二第三两式相加与一式相比即可看出。

于是利用极坐标\\(x=\rho\cos\theta,y=\rho\sin\theta\\)，\\[z=x+yi=\rho(\cos\theta+i\sin\theta)=\rho e^{i\theta}\\]
其中\\(\rho=\sqrt{x^2+y^2}\\)被称为\\(z\\)的模，\\(\theta\\)被称为\\(z\\)的辐角，记作\\(\theta=\arg z\\)。

于是或利用直角坐标，或利用极坐标，得到以下一些基础性质

\\(Re(z)=\frac{z+\bar{z}}{2},Im(z)=\frac{z-\bar{z}}{2}\\)

\\(\tan (\arg z)=\frac{Im(z)}{Re(z)}\\)

\\(z\bar{z}=\vert z\vert ^2\\)

\\(\overline{z_1+z_2}=\bar{z_1}+\bar{z_2},\overline{z_1z_2}=\bar{z_1}\bar{z_2}\\)

\\(\arg(z^3)=3\arg z\\)

### 应用

## 简单应用--证明三角恒等式

(1). 求\\(\cos (\theta+\phi),\sin (\theta+\phi)\\)

\\(\cos (\theta+\phi)+i\sin (\theta+\phi)=e^{i(\theta+\phi)}=e^{i\theta}e^{i\phi}\\)

记\\(C=\cos \theta, S=\sin \theta, c=\cos \phi, s=\sin \phi\\)

上式\\(=Cc-Ss+i(Cs+cS)\\)

于是得\\(\cos (\theta+\phi)=Cc-Ss,\sin (\theta+\phi)=Cs+cS\\)

(2). 三倍角公式

\\(\cos 3\theta+i\sin 3\theta=e^{3i\theta}=(C+iS)^3=(C^3-3CS^2)+i(3C^2S-S^3)\\)

化成另一种更常用的形式为
\\[\sin 3\theta=-4S^3+3S\\]
\\[\cos 3\theta=4C^3-3C\\]

记\\(T=\tan \theta\\)

设\\(z=1+iT\\)，显然\\(\arg z=\theta\\)

\\(z^3=(1+iT)^3=(1-3T^2)+i(3T-T^3)\\)

\\(\tan 3\theta=\tan (3\arg z)=\tan(\arg(z^3))=\frac{3T-T^3}{1-3T^2}\\)

## 代数上的简单应用

考虑积分\\(\int \frac{1}{x^n-1}dx\\)，这个是个有理真分式，对其积分问题主要在于对分母\\(x^n-1\\)的因式分解，随后拆项。

代数基本定理告诉我们\\(n\\)次方程有\\(n\\)个根，因此可以写成\\(n\\)个一次式相乘（改写为零点式的证明附在最后）。对\\(x^n-1\\)而言，其\\(n\\)个零点被称为单位根。

\\(x^n-1\\)的零点即方程\\(x^n=1\\)的解。不妨设其解为\\(\omega=\rho e^{i\theta}\\)，\\(\omega^n=\rho^ne^{in\theta}=1=1\cdot e^{2k\pi i}\\)，因此\\(\rho=1,\theta=\frac{2k\pi}{n},k=0,1,2,...,n-1\\)

故\\(x^n-1=(x-1)(x-e^{\frac{2\pi}{n}})(x-e^{\frac{4\pi}{n}})\cdots(x-e^{\frac{2(n-1)\pi}{n}})\\)

由于复根成对，假如不允许用复数表示，\\(x^n-1\\)最终也一定能分解为若干个一次式和若干个二次式相乘（证明附在最后），因此对\\(\frac{1}{x^n-1}\\)可以进行拆项，随后的积分就比较简单了。

## 几何上的简单应用

见此前的文章[《求封闭曲线面积多种思路》](http://freezingsummer.com/2017/10/Area-of-a-closed-loop/)。

### 变换与欧氏几何

到了本章最精华的部分。这部分内容对复数的需求不是必要的，但是复数却可以作为一种强大的工具。（本章讨论内容均为**平面几何**）

首先，让我们考虑一下“什么是几何？”

这种我们已经十分熟悉的概念却反而难以给出一个精确的定义。粗略地说，“几何就是研究几何性质的学科”。

于是，又得到了新的问题：“什么是几何性质？”

这又需要引入“全等”的概念：“所有全等图形共有的性质被称为几何性质。”

问题又来了，我们需要对“全等”下一个定义。

全等（Congruence）：若存在某个**三维**的运动，使得图形\\(F\\)和\\(F'\\)重合，则称\\(F\\)全等于\\(F'\\)，记作\\(F\cong F'\\)。

（注意：
1. 定义中的运动是三维中的，因为关于某条直线对称的两个三角形显然全等，但不存在二维中的运动使之重合，而必须通过“翻转”这种三维中的运动。
2. 定义中的运动指的是“刚性运动”，即运动过程中任意两点间距离保持不变。用数学语言即：刚性运动:平面\\(A\\)到自身的映射\\(A\mapsto A'=M(A),使\forall X,Y\in A,d(X,Y)=d(M(x),M(Y)),d(x,y)表示(x,y)间距离。\\)）

用“运动”的概念重新理解“几何性质”，几何性质就是“运动中的不变性”。

我们先写下几个看上去十分显然的事实：

 1. \\(F\cong F\\)
 
 2. \\(F\cong F' \Leftrightarrow F'\cong F\\)
 
 3. \\(F\cong F', F'\cong F'' \Rightarrow F\cong F''\\)
 
下面我们用“运动”的思想重新写上述三个事实：

首先设所有的运动集合为\\(G\\),
 
1.存在运动\\(\varepsilon\in G\\)使得\\(F=\varepsilon(F)\\)

2.对任意运动\\(M\in G\\)，存在逆运动\\(M^{-1}\in G\\)使得\\(M\circ M^{-1}=\varepsilon或M^{-1}(M(F))=F\\)
 
3.对于运动\\(N,M\in G\\)，\\(N\circ M\in G\\)

上述语言已经极具暗示性，如果还不够明显，那么再加上第四条对运动而言显然成立的性质：

4.\\(A\circ(B\circ C)=(A\circ B) \circ C\\)，因为不论有无括号，对于运动都是从右向左按C,B,A运算。

于是由于存在单位元，存在逆元，具有封闭性，具有结合律，运动集\\(G\\)实际上是一个群(Group)。

因此克莱因给出了他对几何的定义：“任意选定一个群\\(G\\)，在其上定义一种相应的几何学，几何就是对\\(G\\)群的不变量的研究。”

## 运动的分类

运动可以分为保向运动(Direct Motion)和反向运动(Opposite Motion)。

假如规定角度的顺逆时针方向，保向运动即不改变角度方向的运动：平移、旋转及其复合，反向运动即使角度方向相反的运动：反射及和反射和保向运动的复合。

说了半天，和复数貌似并没有什么关系，下面就将用复数来描述这些运动：

#### 平移

用\\(z\\)代表一个点，\\(T_v(z)=z+v\\)代表将\\(z\\)按\\(v\\)对应向量平移。

显然有：

\\(T^{-1}_v= T _{-v} \\)

\\(T_{v+w}=T_v\circ T_w\\)

#### 旋转

\\(R_a^\theta(z)\\)代表将\\(z\\)以\\(a\\)为中心旋转\\(\theta\\)度。

绕原点的旋转\\(R_o^\theta(z)=e^{i\theta}z\\)

绕任意点的旋转有：

\\(R_a^{\theta+\phi}=R_a^\theta\circ R_a^\phi\\)

\\((R_a^\theta)^{-1}=R_a^{-\theta}\\)

绕任意点\\(a\\)的旋转可以分解为三步：平移到\\(O\\)，旋转\\(\theta\\)，平移回\\(a\\)，即：
\\[R_a^\theta=T_a\circ R_o^\theta\circ T_{-a}\\]
因此\\(R_a^\theta(z)=(T_a\circ R_o^\theta\circ T_{-a})(z)=(z-a)e^{i\theta}+a=e^{i\theta}z+a(1-e^{i\theta})\\)

因此一个任意的旋转可以分解为一个平移加一个绕原点的旋转：
\\[R_a^\theta=T_v\circ R_o^\theta, v=a(1-e^{i\theta})\\]

下面考虑更一般的复合：
\begin{eqnarray}
\nonumber R_b^{\phi}\circ R_a^{\theta}(z)&=&R_b^\phi(e^{i\theta}z+a(1-e^{i\theta}))\\\
\nonumber &=&e^{i\phi}(e^{i\theta}z+a(1-e^{i\theta}))+b(1-e^{i\phi})\\\
\nonumber &=&e^{i(\theta+\phi)}z+ae^{i\phi}(1-e^{i\theta})+b(1-e^{i\phi})\\\
\nonumber &=&(T_v\circ R_o^{\theta+\phi})(z), v=ae^{i\phi}(1-e^{i\theta})+b(1-e^{i\phi})
\end{eqnarray}

\\(\theta+\phi=2k\pi\\)时，显然上述复合是一个纯的平移；

\\(\theta+\phi\ne 2k\pi\\)时，上述复合是一个绕原点的旋转加平移，又由于此前所证，绕原点的旋转加平移可以写成绕某一点的一个旋转，旋转角度就是\\(\theta+\phi\\)，旋转中心点只需套用上述公式就能求得。

综上所述，**任何一个保向运动都可以是一个旋转，或者极少数情况下是一个平移**，写成公式即任意保向运动\\(M(z)=e^{i\theta}z+v\\)。

#### 反射

关于某条直线的反射即关于该直线进行轴对称。

三反射定理：任何一个保向运动均可以写成两个反射的复合；任何一个反向运动都可以写成三个反射的复合。即任何一个运动都可以写成两个或三个反射的复合。

用反射表示保向运动：

1）平移

设\\(L_1,L_2\\)是距离为\\(v\\)的两条平行直线，则先后关于\\(L_1,L_2\\)的反射\\(Rf_2\circ Rf_1\\)等价于向\\(L_1\\)到\\(L_2\\)的方向平移\\(2v\\)。

2）旋转

设\\(L_1,L_2\\)是交角为\\(\theta\\)的两条直线，则先后关于\\(L_1,L_2\\)的反射\\(Rf_2\circ Rf_1\\)等价于从\\(L_1\\)到\\(L_2\\)的方向绕交点旋转\\(2\theta\\)。

又因为所有的保向运动都可以表示为一个旋转或者平移，因此两个反射的复合可以表示所有的保向运动。

而所有的反向运动只需要一个保向运动加一个反射即可完成，即只需要三次反射。

此外，所有的保向运动可以形成一个子群，但是反向运动不行（反向运动不存在恒等运动\\(\varepsilon\\)）。

## 相似

仅有运动还不足以定义欧式几何，因为欧式几何还具有一定的普适性：比如勾股定理，对于厘米适用，对于米和千米同样适用，这就说明欧式几何中的几何性质，不仅适用于全等的图形，还适用于相似的图形。

相似：保持平面点之间距离之比不变的映射。

对任意一个相似变换\\(S^r\\)（r是相似比），有如下基本性质：

\\(S^k\circ S^r=S^{kr}\\)

\\((S^r)^{-1}=S^{\frac{1}{r}}\\)

相似的一个特例是位似，关于某点\\(a\\)的位似记为\\(D_a^r\\)，

位似变换后再加一个旋转即可得到“伸缩旋转”\\(D_a^{r,\theta}\\)，即关于\\(a\\)位似后，再关于\\(a\\)旋转\\(\theta\\)。

之所以要提出“伸缩旋转”这个概念是因为其和复数有很直接的关系：进行一次关于原点的伸缩变换可以表示为乘上一个复数，即
\\[D_o^{r,\theta}(z)=re^{i\theta}z\\]

在[《求封闭曲线面积多种思路》](http://freezingsummer.com/2017/10/Area-of-a-closed-loop/)中提到了《复分析：可视化方法》中独创的一个概念：复变函数导数的几何意义----伸扭，其实就是一个伸缩旋转。对于\\(w=f(z)\\)，有\\(dw=f'(z)dz\\)，其实\\(dw\\)就是对\\(dz\\)进行一个\\(f'(z)\\)的伸缩旋转得到的。

关于原点伸缩旋转后再进行一次平移就可以得到所有的“保向相似”，保向相似即一个线性变换：\\(Sd^r(z)=wz+v\\)。而所有的相似都可以写成一个运动加一个位似。

类似的所有的保向相似形成一个子群，而反向相似不行。

## 欧式几何的定义

最终我们可以给欧式几何下一个定义了：

**欧式几何就是对相似变换群不变量的研究。**

\\
\\
\\
\\[\\]

# 附 
## 1.三次方程求根公式的推导
对于任意三次方程
\\[x^3+Bx^2+Cx+D=0\\]
设\\(x=y-\frac{B}{3}\\)，可将二次项消去：
\\[y^3+(C-\frac{1}{3}B^2)y+\frac{2}{27}B^3-\frac{BC}{3}+D=0\\]

将上述方程记为如下形式：
\\[y^3=3py+2q\\]
设\\(y=s+t\\)，代入得
\\[s^3+3s^2t+3st^2+t^3=3ps+3pt+2q\\]
显然，若\\(st=p且s^3+t^3=2q\\)则上式成立，\\(s+t\\)为方程的一个根。
将\\(t=\frac{p}{s}\\)代入\\(s^3+t^3=2q\\)得到关于\\(s^3\\)的二次方程：
\\[(s^3)^2-2qs^3+p^3=0\\]
此方程有两个解，由于\\(s\\)和\\(t\\)是对称的，所以两个解一个为\\(s\\)，另一个为\\(t\\)。不妨记
\\[s^3=q+\sqrt{q^2-p^3}\\]
\\[t^3=q-\sqrt{q^2-p^3}\\]
于是\\(y=s+t=\sqrt[3]{q+\sqrt{q^2-p^3}}+\sqrt[3]{q-\sqrt{q^2-p^3}}\\)
至此得到了三次方程的一个根。

## 2.多项式的零点式

设\\(G_m=c^m+c^{m-1}z+...+cz^{m-1}+z^m\\)，这是一个首项为\\(c^m \\)，公比为\\(\frac{z}{c}\\)的等比数列求和，故\\(G_m=\frac{z^{m+1}-c^{m+1}}{z-c}\\)。

所以\\(z^n-c^n=G_{n-1}(z-c)\\)。

考虑\\(n\\)次多项式\\(P_n(z)=A_nz^n+A_{n-1}z^{n-1}+...+A_2z^2+A_1z+A_0\\),

\begin{eqnarray}
\nonumber P_n(z)-P_n(c)&=&(z-c)(A_nG_{n-1}+A_{n-1}G_{n-2}+...+A_2G_1+A_1)\\
\nonumber &=&(z-c)P_{n-1}
\end{eqnarray}

其中\\(P_{n-1}\\)是某个关于\\(z\\)的\\(n\\)次多项式。

若\\(P_n(c)=0\\)，即\\(c\\)是\\(P_n(z)\\)的一个零点，则有
\\[P_n(z)=(z-c)P_{n-1}\\]

重复上述操作，一定可以得到
\\[P_n(z)=(z-c_1)(z-c_2)\cdots(z-c_n)\\]

于是把\\(P_n(z)\\)写成了零点式，\\(c_1,c_2,...c_n\\)是多项式的\\(n\\)个零点。

此外，代数基本定理还包含了复根成对，这是因为，若\\(P_n(c)=0\\)，设\\(c=\rho e^{i\theta}\\)，则

\\[P_n(c)=A_nc^n+A_{n-1}c^{n-1}+...+A_1z+A_0=0\\]

式子两边同时取共轭,

\\[P_n(\bar{c})=A_n\bar{c}^n+...+A_0=0\\]

故复根成对出现。

考虑成对出现的两个因式\\((z-c)(z-\bar{c})=z^2-(c+\bar{c})z+c\bar{c}=z^2-2Re(c)+\vert c\vert^2\\)，显然是一个实多项式。

