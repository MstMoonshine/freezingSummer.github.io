---
layout: post
tags: mathematica
title: 微分算符在解微分方程中的应用
---

此前在[用线性空间思想寻找线性微分方程解的结构](http://freezingsummer.com/2017/11/Linear_space&diffierential_equation/)一文中提到会在日后的“物理”文章中介绍二阶常系数微分方程的解法。但是最近对微分方程有了些新的感悟，便不打算在写物理的文章中介绍了，而是直接写一篇关于微分方程的文章。（不知道什么时候会写第一篇关于物理的文章。。。）

### 二阶常系数齐次微分方程

二阶常系数齐次微分方程：
\\[y''+Py'+Qy=0\\]

物理书上对此类方程的解法通常是给出通解形式，再代回验证并求出参数。这种方法往往令初学者困惑不已。

这是因为微分方程并没有通用的解法，只能根据不同的形式去找出不同的解法。而物理中的微分方程人们更偏向于用物理意义去猜出答案。猜解的形式的确是解微分方程中最重要的技巧之一。

同济微积分上册给出的方法是，先观察原方程，猜出解可能是指数形式，再代回找到指数函数中\\(x\\)前系数应满足“特征方程”：\\(r^2+Pr+Q=0\\)。然后分两实根、两虚根和两相同根三类情况讨论解的形式。此方法就不再详细说明了，网上资料很多。

下面要介绍的方法类似，但是可以拓宽思路。

### 微分算符解法

与此前文章类似，我们引入微分算符\\(D=\frac{d}{dx}\\)，于是原方程改写为：
\\[D^2y+PDy+Qy=0\\]
将\\(y\\)作为公因式提出来：
\\[(D^2+PD+Q)y=0\\]
下面我们先用一种看似十分不合理的方法来处理，此后再给出解释：将\\(D\\)视为一个数。显然\\(y\\)恒等于\\(0\\)是一个trivial解，我们不加以讨论。\\(y\\)不恒等于\\(0\\)的前提下，上式成立的条件便是\\(D^2+PD+Q=0\\)。

这是一个关于\\(D\\)的二次方程，注意此方程的形式和此前“特征方程”\\(r^2+Pr+Q=0\\)具有相同的形式。

1).此方程有两个不同实根

设两根为\\(d_1,d_2=\frac{-P\pm\sqrt{P^2-4Q}}{2}\\)

\\(D=d_1\\)时，\\(Dy=\frac{dy}{dx}=d_1y\\)，这是一个最简单的一阶微分方程，于是此时\\(y=Ce^{d_1x}\\)。

同理，\\(D=d_2\\)时有：\\(y=Ce^{d_2x}\\)。根据齐次方程解的叠加原理（见此前文章），最终通解为上述两个线性独立解的叠加（\\(\frac{y_1}{y_2}\\)不为常数称其线性独立），即通解为：\\(y=C_1e^{d_1x}+C_2e^{d_2x}\\)，\\(C_1、C_2\\)为任意常数。

2).有两个相同实根

\\(d_1=d_2=-\frac{P}{2}\\)，此时有：
\\[(D+\frac{P}{2})^2y=(D+\frac{P}{2})(D+\frac{P}{2})y=0\\]
设\\(z=(D+\frac{P}{2})y\\)，则有：
\\[(D+\frac{P}{2})z=0\\]
得\\(Dz=\frac{dz}{dx}=-\frac{P}{2}z\\)

因此
\\[z=Ce^{-\frac{P}{2}x},C为任意常数\\]
代回解\\(y\\)：
\\[(D+\frac{P}{2})y=z=Ce^{-\frac{P}{2}x}\\]
即
\\[\frac{dy}{dx}+\frac{P}{2}y=Ce^{-\frac{P}{2}x}\\]

此方程对应的齐次方程为：\\(\frac{dy}{dx}+\frac{P}{2}y=0\\)，即齐次方程通解为：\\(y=C_1e^{-\frac{P}{2}x}\\)

特解\\(y=Cxe^{-\frac{P}{2}x}\\)（此处\\(C\\)不是任意常数，而是等同于\\(z\\)中的\\(C\\)，对每一个确定的\\(z\\)，这是一个特解）。

于是通解为\\(y=(Cx+C_1)e^{-\frac{P}{2}x}\\)。（代入\\(z\\)解\\(y\\)时，\\(C\\)不被看做任意常数，因为对每一个\\(z\\)，\\(y\\)的特解是固定的。但此时最终\\(z\\)不是特定的，所以\\(C\\)和\\(C_1\\)都是任意常数）

3).两个虚根
此时\\(d_1,d_2=d_1,d_2=\frac{-P\pm\sqrt{P^2-4Q}}{2}=d_1,d_2=\frac{-P\pm i\sqrt{4Q-P^2}}{2}\\)

代入1)中形式：
\\[y=C_1e^{d_1x}+C_2e^{d_2x}=e^{-\frac{P}{2}}(C_1e^{i\frac{\sqrt{4Q-P^2}}{2}x}+C_2e^{-i\frac{\sqrt{4Q-P^2}}{2}x})\\]
记\\(k=\frac{\sqrt{4Q-P^2}}{2}\\)，
\\[y=e^{-\frac{P}{2}}((C_1+C_2)\cos kx+i(C_1-C_2)\sin kx)\\]
这是在复数域上的通解。但此处\\(y\\)应当是实数，因此需要要求\\(C_1,C_2\\)虚部相同，得到
\\[y=e^{-\frac{P}{2}}(\alpha\cos kx+\beta\sin kx)\\]

### 微分算符的“特征值”

最终解出的三种结果的确是正确的，但是这种方法初次接触实在让人难以理解。学到矩阵的特征值与特征向量后，我对此法有了自己的理解。

上述方法中最关键也是最不易理解的一步在于“将\\(D\\)视为一个数”。

或许应该换一种更合理的说法：\\(D\\)不是一个数，但是\\(D\\)对\\(y\\)的作用效果等价于一个数，即\\(Dy=\lambda y\\)。

这和矩阵的特征值十分相似，我们不妨将其称为微分算符\\(D\\)的“特征值”（自创，非权威说法）。显然不是所有的\\(y\\)都满足上式。因为\\(Dy=\frac{dy}{dx}=\lambda y\\)可以解得\\(y=Ce^{\lambda x}\\)，故仅当\\(y\\)是以\\(e\\)为底的指数形式时，才满足上式，我们不妨将\\(y=Ce^{\lambda x}\\)称为关于特征值\\(\lambda\\)的“特征函数”。

也就是说，我们之所以能接出正确结果，是因为我们提前默认解是指数形式的，也算是误打误撞。但是对于其他形式的微分方程，在不知道解是否为指数形式时，不妨用此法先尝试，再待会检验，相当于提供了一个猜根的思路。

上述结果还说明了\\(e\\)这个数以及\\(e^x\\)这个函数在微分方程中的重要性----作为微分方程标志的微分算符\\(D\\)的特征函数就是\\(e^x\\)形式，足以说明其特别。

### D的其他妙用

1.
前段时间在物理题中遇到了如下形式的微分方程：
\\[\frac{dv}{dt}+\frac{v^2}{y}=g\\]
求\\(v\\)关于\\(y\\)的表达式。

首先先把变量\\(t\\)消去：
\\[\frac{dv}{dy}\cdot\frac{dy}{dt}=v\frac{dv}{dy}\\]
于是：
\\[\frac{d(v^2)}{2dy}+\frac{v^2}{y}=g\\]
记\\(D=\frac{d}{dy}\\)
\\[\frac{1}{2}D(v^2)+\frac{v^2}{y}=v^2(\frac{1}{2}D+\frac{1}{y})=g\\]
\\[v^2=\frac{g}{\frac{1}{2}D+\frac{1}{y}}=\frac{gy}{\frac{1}{2}Dy+1}\\]
注意到\\(Dy=\frac{dy}{dy}=1\\)
\\[v^2=\frac{2}{3}gy\\]
代回检验无误。（检验很重要，因为这种方法没有正确保证，只是提供解方程的一种思路）

2.用微分算符表示差分算符

此思路来自[科学空间](http://spaces.ac.cn/archives/3018/)。

差分方程和微分方程在很多情况下具有惊人的相似性。从物理的角度来看，微分方程就是连续的情况，而考虑离散的点就是差分方程。

而通过以下方法，我们可以将差分方程和微分方程统一：

记\\(\Delta_hf(x)=\frac{f(x+h)-f(x)}{h}\\)

当\\(h=1\\)时，\\(\Delta_1f(x)=\Delta f(x)=f(x+1)-f(x)\\)

当\\(h\rightarrow 0\\)时，\\(\Delta_0f(x)=Df(x)\\)表示微分

到这还没有结束，我们对\\(f(x+h)\\)在\\(x\\)处泰勒展开：
\begin{eqnarray}
\nonumber f(x+h)&=&f(x)+f'(x)h+\frac{1}{2}f''(x)h^2+...\\
\nonumber &=&f(x)+Df(x)h+\frac{1}{2}D^2f(x)h^2+...\\
\nonumber &=&(1+hD+\frac{1}{2}h^2D^2+...)f(x)\\
\nonumber &=&e^{hD}f(x)
\end{eqnarray}

于是代入\\(\Delta_hf(x)\\)的表达式得：
\\[\Delta_hf(x)=\frac{f(x+h)-f(x)}{h}=\frac{e^{hD}-1}{h}f(x)\\]
故可以用\\(D\\)表示出\\(\Delta_h\\)：
\\[\Delta_h=\frac{e^{hD}-1}{h}\\]

显然\\(h=1\\)时，给出\\(\Delta=e^{D}-1\\)

而\\(h\rightarrow 0\\)时，用洛必达法则正好得到：\\(\Delta_0=D\\)

3.用差分算符解差分方程

形如\\(a_{n+2}=Aa_{n+1}+Ba_n\\)的二阶差分方程。我们不妨延拓到实数域对应：
\\[f(x+2)=Af(x+1)+Bf(x)\\]
用上述差分算符表示为：
\\[e^{2D}f(x)=Ae^Df(x)+Bf(x)\\]
约去\\(f(x)\\)
\\[(e^D)^2=Ae^D+B\\]
这是关于\\(e^D\\)的二次方程。（注意在复数域上\\(e^x\\)可以表示除了\\(0\\)以外任意复数）类似此前，上述方程可以有两同根两异根。

以两不同根为例，设其两根为\\(e^D=\alpha,\beta\Rightarrow D=\ln\alpha,\ln\beta\\)。

\\[Df(x)=\frac{df(x)}{dx}=\ln\alpha f(x)\Rightarrow f(x)=C_1\alpha^x\\]

同理另一组解为\\(f(x)=C_2\beta^x\\)

此差分方程解为\\(a_n=f(n)=C_1\alpha^x+C_2\beta^x\\)，其中\\(C_1,C_2\\)由\\(a_1,a_2\\)或其他任意两项决定。

# EOF
关于算符的运算是有一套严密的研究的，此处我只是将其不严谨地拿来借用，而仅仅对这些理论的一瞥便显示出了其强大的威力。但是由于我并未专门研究这些理论的适用条件，所以大多情况下只能作为一种思路，必须加以检验。